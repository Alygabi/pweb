!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="b8c8b7de-8a84-38c7-92e0-e97f8e71bf8e")}catch(e){}}();
define(["exports","react","./e_file_viewer_static_scl_page_file","./c_file_transfers_async_browse_entry_point_onboarding_modal_async","./e_data_modules_stormcrow","./e_edison","./c_shareme24_main","./c_utils_dsx_dsx-react","./c_shareme24_browse_integration_logger","./c_memoize-one","./c_api_v2_client_base","./c_api_v2_routes_password_confirmation_provider","./c_init_data_debug_panel","./c_browser_browser_detection","./c_src_sink_index","./c_browse_welcome_hub_lib_types","./c_init_data_edison","./e_core_exception","./c_pap-events_navigation_select_create_folder_action","./c_core_i18n","metaserver/static/js/langpack","./c_lodash-es_lodash","./c_watermarking_utils_getImageDefaultSizes","./c_core_notify","react-dom","./c_react-use_misc_util","./c_security_csrf_hmac","./c_src_common_constants","./c_upload_kit_lib_types","./c_api-v2-client_src_dropbox","./c_react_query_helpers_queries_login_and_register_constants","./c_ui_share-blocking-wrapper_share_blocking_wrapper","./c_base64","./c_maestro_nav_shared_code_dropbox_logo","./c_dig-content-icons_icons_folder-shared-default-small","./c_dig-content-icons_hooks_useContentIconViewbox","./c_shared_with_redux_store","./c_browse_shared_with_api","./c_sharing_avatar_info","./c_contacts_contact","./c_validators","./c_sharing_sharing_pap_logging_send_share_invite_util","./c_dig-components_typeahead_index","./c_dig-icons_assets_ui-icon_line_share","./c_dig-icons_assets_ui-icon_line_settings","./c_dig-icons_assets_ui-icon_line_undo"],(function(e,t,a,r,n,i,o,s,l,c,d,_,u,f,p,g,m,E,b,y,h,S,v,I,O,C,w,x,T,M,$,k,F,P,A,R,L,N,D,W,j,G,B,V,H,q){"use strict";function U(e){if(e&&e.__esModule)return e;var t=Object.create(null);return e&&Object.keys(e).forEach((function(a){if("default"!==a){var r=Object.getOwnPropertyDescriptor(e,a);Object.defineProperty(t,a,r.get?r:{enumerable:!0,get:function(){return e[a]}})}})),t.default=e,Object.freeze(t)}var z=U(t);const Y=(e,t)=>"previews"===e?a.SHARE_ACTION_ORIGIN_TYPE.PREVIEW_PAGE:"split_share_menu"===t?a.SHARE_ACTION_ORIGIN_TYPE.BROWSE_GLOBAL_ACTIONS:a.SHARE_ACTION_ORIGIN_TYPE.BROWSE_FILE_ACTIONS,J=e=>{const t=(e=>s.useInitStore(e,(e=>{const t=s.proxy((()=>e.get().fileOrFolder)),a=s.proxy((()=>e.get().user)),r=s.proxy((()=>e.get().shareModalExtras)),n=s.proxy((()=>e.get().actionSurface)),i=s.proxy((()=>e.get().actionElement)),o=s.proxy((()=>e.get().progressiveInbandVariant)),l=s.store(Date.now()),c=s.store(void 0),d=s.store(e.get().isOpen),_=s.proxy((()=>e.get().sessionId)),u=s.proxy((()=>e.get().displayType)),f=s.proxy((()=>{const t=e.get();if("anchored"===t.displayType)return t.modalRef})),p=s.proxy((()=>{const t=e.get();if("anchored"===t.displayType)return t.overlayPlacement}));return{$fileOrFolder:t,$user:a,$shareModalExtras:r,$isOpen:d,$actionSurface:n,$actionElement:i,$progressiveInbandVariant:o,$openFlexibleEntryPointTimestamp:l,$dwellFlexibleEntryPointActionTimestamp:c,$sessionId:_,$displayType:u,$modalRef:f,$overlayPlacement:p,$props:e}})))(e),a=Y(e.actionSurface,e.actionElement);return z.default.createElement(z.default.Fragment,null,z.default.createElement(o.SharingSdkProvider,{userApiProps:e.user,origin:a,actionInfo:{actionSurface:e.actionSurface}},z.default.createElement(K,{store:t})))};J.displayName="ShareMe24Browse";const K=({store:e})=>{var t,n;const i=s.useStore(e.$fileOrFolder),l=i.is_dir,c=s.useStore(e.$actionElement),d=s.useStore(e.$actionSurface),_=s.useStore(e.$sessionId),u=s.useStore(e.$isOpen),f=s.useStore(e.$modalRef),p=s.useStore(e.$overlayPlacement),m=s.useStore(e.$displayType),E=(e=>z.default.useCallback((()=>{e.$props.get().onRequestClose(),e.$dwellFlexibleEntryPointActionTimestamp.set(void 0)}),[e]))(e),b=(e=>z.default.useCallback((()=>{e.$props.get().onInbandShareCompleted(),e.$isOpen.set(!1)}),[e]))(e),y=z.useCallback((async e=>{a.markMilestoneAsCompleted(e,g.ActivationTileMilestoneId.SHARE_CONTENT)}),[]),{onActionClicked:h,user:S}=e.$props.get(),v=z.default.useMemo((()=>i.is_dir?i.target_ns?{".tag":"shared_folder",sharedFolderId:String(i.target_ns),fileId:i.file_id}:{".tag":"file_folder",name:i.ns_path.split("/").pop()||"",path:i.fq_path,fileId:i.file_id}:{".tag":"file",fileId:i.file_id}),[i]),I=z.default.useMemo((()=>i.is_dir?i.target_ns?{type:"shared_folder"}:{type:"file_folder"}:{type:"file",name:a.filename(i.fq_path),size:i.bytes}),[i]),O=z.default.useMemo((()=>({actionSurface:d,actionElement:c,contentAction:"share",tiburonOrigin:Y(d,c),screen:"share_screen",shareModalType:"sm24"})),[d,c]),C=s.useStore(e.$progressiveInbandVariant),w=s.useStore(e.$props).onFallback,{data:x,isLoading:T}=a.useSharingPrefs(),M=null!==(t=null==x?void 0:x.apiData.is_file_transfer_enabled)&&void 0!==t&&t,$=i.is_dir?r.folderEligibleForTransfer(i):!i.is_cloud_doc,k=S.is_team_admin,F=T,P=null!==(n=a.useSelector((e=>a.browsePostTTIExperiments(e).expSm24CopyLinkLoadingState)))&&void 0!==n?n:"OFF";z.default.useEffect((()=>{"OFF"!==P&&a.logExposure({feature:"sm24_copy_link_loading_state",variant:P})}),[P]);const A=a.useShowCopyLinkMiniModalWithoutLockedStateModalCallback(),R=z.default.useMemo((()=>"previews"!==d&&"centered"===m?{displayMode:"centered_v1"}:{displayMode:"anchored_v1",displayModeRef:f,displayModePositioning:p}),[d,m,f,p]),L=z.default.useCallback((()=>{const{actionSurface:t,actionElement:a,fileOrFolder:r,user:n,...i}=e.$props.get();let o=()=>{};const s=new Promise((e=>{o=e}));if("undefined"!=typeof ClipboardItem&&navigator.clipboard.write){const e=new ClipboardItem({"text/plain":s});navigator.clipboard.write([e])}else s.then((e=>navigator.clipboard.writeText(e)));const l={write:e=>o(e)},c="undefined"!=typeof window&&window.innerWidth<=800?"bottom":p;y(n);const d="anchored"===i.displayType?{isCenteredDisplayed:!1,anchorRef:i.modalRef,placement:c,yOffsetDistance:5}:{isCenteredDisplayed:!0};A.fn({user:n,filePath:r.file_id,setIsCreatingSharedLink:()=>{},browseFile:r,zIndexOverride:500,actionSurface:t,actionElement:a,origin:Y(t,a),isFromShareMe24Modal:!0,clipboardWriter:l,...d})}),[e.$props,p,A,y]),N=z.default.useCallback((()=>{const{user:t,fileOrFolder:a,actionSurface:n,actionElement:i}=e.$props.get(),o=`sm24_${n}_${i}`,s=[a];r.asyncShowBrowseEntryPointOnboardingModal({primaryActionOnClick:()=>r.redirectToCreateTransferWithFiles(s,o),userId:t.id})}),[e]),D=(e=>z.default.useCallback((t=>{const r=e.$props.get(),n=r.user,i=r.fileOrFolder,o={...r.shareModalExtras,initialScreen:a.SETTINGS_SCREEN,openSettingsFromShareMe24:!0,openLinkSettings:t.shouldOpenLinkSettings,initialTab:t.initialTab};a.asyncShowShareModal(n,i,o)}),[e]))(e);return z.default.createElement("div",null,z.default.createElement(o.MetadataProvider,{sharingObjectIdentifier:v,shareModalSessionId:_},z.default.createElement(a.ContextProvider,{context:o.Context,value:_},z.default.createElement(a.ContextProvider,{context:o.Context$1,value:O},z.default.createElement(a.ContextProvider,{context:o.Context$2,value:I},z.default.createElement(o.Provider,{objectIdentifier:v,sessionId:_,objMetadataNewApiVariant:"OFF"},z.default.createElement(X,{sessionId:_,actionElement:c,actionSurface:d,isDir:l},z.default.createElement(Q,{onFallback:w},z.default.createElement(o.Main,{...R,isOpen:u,onRequestClose:E,inbandSharingMode:"controlled_v1",copyLinkMode:"controlled_v1",copyLinkHandler:L,copyLinkLoadingStateVariant:P,transferMode:"controlled_v1",transferHandler:N,settingsMode:"controlled_v1",settingsHandler:D,objectIdentifier:v,progressiveInbandVariant:C,canUserUseTransfer:M,canContentUseTransfer:$,canUserEnableTransfer:k,isTransferEligibilityLoading:F,referrerLoggingMetadata:O,objectLoggingMetadata:I,onActionClicked:h,onInbandShareCompleted:b,fileOrFolder:i})))))))))};K.displayName="ShareMe24BrowseInternals";const Q=({children:e,onFallback:a})=>{const r=o.useData(),n=z.default.useRef(!1);return t.useEffect((()=>{"error"!==r.status||n.current||(n.current=!0,a())}),[r.status,a]),"error"===r.status?null:z.default.createElement(z.default.Fragment,null,e)};Q.displayName="DataLoadingFallbackWrapper";const X=({children:e,sessionId:a,actionElement:r,actionSurface:n,isDir:i})=>{const s=o.useData(),c=z.default.useRef(!1);return t.useEffect((()=>{if(!c.current)return"error"===s.status?(c.current=!0,void l.defaultEmitter.select(l.ON_LOADING_WRAPPER_DETECT_FAILURE).emit({sessionId:a,actionElement:r,actionSurface:n,isDir:i})):"loaded"===s.status?(c.current=!0,void l.defaultEmitter.select(l.ON_LOADING_WRAPPER_DETECT_SUCCESS).emit({sessionId:a,actionElement:r,actionSurface:n,isDir:i,isSharingBanned:s.accountMetadata.is_sharing_banned})):void 0}),[s.status,a,r,n,i]),t.useEffect((()=>()=>{c.current||(c.current=!0,l.defaultEmitter.select(l.ON_LOADING_WRAPPER_DETECT_CANCEL).emit({sessionId:a,actionElement:r,actionSurface:n,isDir:i}))}),[]),z.default.createElement(z.default.Fragment,null,e)};X.displayName="DataLoadingLogger",e.DataLoadingFallbackWrapper=Q,e.ShareMe24Browse=J}));
//# sourceMappingURL=c_shareme24_browse_integration_index.after-display.js-vflw3jmjb.map

//# debugId=b8c8b7de-8a84-38c7-92e0-e97f8e71bf8e