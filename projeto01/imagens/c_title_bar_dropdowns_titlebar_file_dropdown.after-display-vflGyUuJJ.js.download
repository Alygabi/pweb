!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="aa628ee5-bc2a-3010-9563-1c8e7140a2c6")}catch(e){}}();
define(["require","exports","react","./e_file_viewer_static_scl_page_file","./c_core_i18n","./c_flows_conversions_conversion_actions","./c_dig-icons_assets_ui-icon_line_print","./c_action_plugins_open_in_action_dropdown","./c_lodash-es_lodash","./c_cloud_docs_open_with_utils","./c_file_viewer_components_titlebar_menu_content","./c_memoize-one","./e_core_exception","./c_src_sink_index","./c_browser_browser_detection","./e_edison","./c_api_v2_routes_password_confirmation_provider","./c_init_data_edison","./c_init_data_debug_panel","./c_pap-events_navigation_select_create_folder_action","./e_data_modules_stormcrow","./c_react-use_misc_util","./c_api_v2_client_base","./c_watermarking_utils_getImageDefaultSizes","./c_core_notify","react-dom","./c_security_csrf_hmac","metaserver/static/js/langpack","./c_dig-icons_assets_ui-icon_line_upload","./c_dig-icons_assets_ui-icon_line_video","./c_react-use_useEffectOnce","./c_icon_templates_stateless_index","./c_spectrum_svg_icon_bundle","./c_shared_components_templates_modal_template","./c_profile_services_profile_services_link","./c_abuse_login_and_register_constants_fetch","./c_react_query_helpers_queries_login_and_register_constants","./c_api_v2_default_team_client","./c_dig-icons_assets_ui-icon_line_home","./c_gdd_migration_ui_utils","./c_file_imports_gdrive_file_picker","./c_shortcuts_conversion_utils","./c_icon_shortcuts_icon","./c_spectrum-content-icon-compatibility_src_file_icon","./c_dig-content-icons_icons_file-unknown-large","./c_dig-content-icons_hooks_useContentIconViewbox","./c_dig-content-icons_hooks_useThemedStyle","./c_dig-content-icons_icons_file-link-large","./c_dig-content-icons_icons_file-video-small","./c_dig-content-icons_icons_folder-shared-default-small","./c_dig-content-icons_icons_folder-base-default-large","./c_dig-content-icons_icons_folder-base-default-small","./c_icon_folder_icon","./c_ui_title_bubble","./c_ui_overlay","./c_cloud_docs_hooks","./c_extensions_open_button_utils","./c_spectrum_modal_utility_modal","./c_spectrum_button","./c_spectrum_tertiary_link","./c_icon_templates_actionable_index","./c_ui_image","./c_dig-icons_assets_ui-icon_line_shuffle","./c_ui_sprite","./c_dig-icons_assets_ui-icon_line_sidebar-show-right","./c_dig-icons_assets_ui-icon_line_admin-console"],(function(e,i,n,t,o,r,c,s,a,l,_,u,d,S,f,v,p,w,A,I,E,P,h,g,C,T,m,D,b,O,N,R,L,y,F,K,M,k,x,U,V,H,G,B,W,z,Y,j,q,X,Z,Q,$,J,ee,ie,ne,te,oe,re,ce,se,ae,le,_e,ue){"use strict";function de(e){if(e&&e.__esModule)return e;var i=Object.create(null);return e&&Object.keys(e).forEach((function(n){if("default"!==n){var t=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(i,n,t.get?t:{enumerable:!0,get:function(){return e[n]}})}})),i.default=e,Object.freeze(i)}var Se=de(n);const fe={...t.fileActionCondition,filterValidFile:e=>{const i=t.fileActionCondition.filterValidFile(e);return!i||t.isInsideVaultFolder(i)||t.isPnmSuppressMoveSelected(i)||t.isEncryptedFile(i)?void 0:i}},ve=t.withActionCondition(fe,((i,n,o,r)=>({label:t.COPY_ACTION_STRING,userAction:t.UserAction.Copy,icon:t.CopyLine,action:{type:"click",handler:()=>new Promise((function(i,n){e(["./c_action_plugins_copy_action_action"],i,n)})).then((({copyActionWrapper:e})=>e({file:i.file,user:i.user,previewType:n,browseContext:o,browseExceptions:r})))},disabled:{disabled:!1}})),void 0),pe=t.withActionCondition(t.deleteActionCondition,((i,n,o,r,c)=>({label:t.DELETE_ACTION_STRING,icon:t.DeleteLine,userAction:t.UserAction.Delete,disabled:i.file.read_only?{disabled:!0,tooltipMessage:t.ACTION_DISABLED_STRING}:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,n){e(["./c_action_plugins_delete_action_action"],i,n)})).then((({deleteActionWrapper:e})=>e({logUserAction:n,setDeleteFileModalOpenCallback:o,file:i.file,user:i.user,previewSurface:r,onFileChanged:c})))}})),void 0),we=[t.SDKPreviewSurface.BROWSE,t.SDKPreviewSurface.FILE_LOCKING,t.SDKPreviewSurface.HELLOSIGN,t.SDKPreviewSurface.HOME,t.SDKPreviewSurface.INBAND_SHARE,t.SDKPreviewSurface.PHOTOS,t.SDKPreviewSurface.RECENTS,t.SDKPreviewSurface.SEARCH,t.SDKPreviewSurface.SHARED_COLLECTION,t.SDKPreviewSurface.SHARED_CONTENT_LINK,t.SDKPreviewSurface.SHARED_LINK,t.SDKPreviewSurface.SHARED_LINK_EMBED,t.SDKPreviewSurface.SHARED_COLLECTION,t.SDKPreviewSurface.STANDALONE_PREVIEW,t.SDKPreviewSurface.STARRED,t.SDKPreviewSurface.TRANSFER,t.SDKPreviewSurface.UNKNOWN,t.SDKPreviewSurface.VERSION_HISTORY,t.SDKPreviewSurface.FSS_DESKTOP_PREVIEW],Ae={filterValidFile:t.allowAllFiles,filterValidUser:t.filterLoggedInUser,shouldShowForPreviewSurface:t.filterSurfaceIn(we),shouldShowForPreviewType:t.alwaysShow},Ie=t.withActionCondition(Ae,((e,i)=>({userAction:void 0,icon:t.FileHistoryLine,label:t.FILE_ACTIVITY_ACTION_STRING,accessibleLabel:t.FILE_ACTIVITY_ACCESSIBILITY_STRING,action:{type:"click",handler:async()=>i()},disabled:{disabled:!1}})),void 0);const Ee=e=>{const{conversionActions:i,file:n}=e,t=i.filter((e=>e.actionGroup===r.ConversionActionGroup.VIDEO_SCALE)),o=i.filter((e=>e.actionGroup!==r.ConversionActionGroup.VIDEO_SCALE)),c=o.length>0?Pe(o,n,e):null,s=t.length>0?Pe(t,n,e):null;return Se.default.createElement(Se.default.Fragment,null,c,s)},Pe=(e,i,n)=>Se.default.createElement(t.Menu.Segment,null,e.map((e=>{const r=i.bytes/Math.pow(1024,2),c=t.getConversionFileSizeLimitMB([t.file_extension(t.getFilename(i))],e.actionText),s=r>c,a=o.intl.formatMessage({id:"0vePbC",defaultMessage:"File is larger than the {fileSizeLimitMB}MB limit"},{fileSizeLimitMB:c}),l=Se.default.createElement(t.Menu.ActionItem,{key:e.actionText,disabled:s,value:{handler:()=>(({file:e,user:i,action:n,encryptionOptions:o,logUserAction:r,context:c,shareToken:s,actionSurface:a="",sharedLinkInfo:l,sharePermissions:_,previewSurface:u})=>{if(r(t.UserAction.SelectSaveAs,c,{conversion_type:n.actionText,actionSurface:a}),i)n.convert([e],i,{shareToken:s,source:"preview"});else{const e=new URL(window.location.href);e.searchParams.set("save_as","true"),e.searchParams.set("save_as_action",n.actionText),window.history.replaceState(e.href,"",e.href),t.showAuthModal({mode:t.Mode.REGISTER,sharedLinkUrl:e.href,kind:t.LoginOrRegisterKind.POSTSAVEAS,encryptionOptions:o,loggingExtra:{signup_source:"save_as"},signupTag:t.RegistrationSource.SHMODEL_SAVE_AS_REGISTER,webSignInTag:t.getWebSignInTag(!1,u,_),authDialogPreviousElement:t.AuthDialogPreviousElementTag.SAVE_AS,sharedLinkInfo:l})}})({...n,action:e})},withLeftAccessory:Se.default.createElement(t.UIIcon,{src:e.actionIcon,width:"20px",height:"20px"})},e.actionText);return s?Se.default.createElement(t.Tooltip,{key:e.actionText,title:a,placement:"left",id:"flows-disabled-menu-item-tooltip"},Se.default.createElement("div",null,l)):l}))),he=[t.SDKPreviewSurface.BROWSE,t.SDKPreviewSurface.FILE_LOCKING,t.SDKPreviewSurface.HELLOSIGN,t.SDKPreviewSurface.HOME,t.SDKPreviewSurface.INBAND_SHARE,t.SDKPreviewSurface.PHOTOS,t.SDKPreviewSurface.RECENTS,t.SDKPreviewSurface.SEARCH,t.SDKPreviewSurface.SHARED_CONTENT_LINK,t.SDKPreviewSurface.SHARED_LINK,t.SDKPreviewSurface.STANDALONE_PREVIEW,t.SDKPreviewSurface.STARRED,t.SDKPreviewSurface.FSS_DESKTOP_PREVIEW,t.SDKPreviewSurface.LOW_DISTRACTION_VIEW],ge={filterValidFile:e=>!e||t.isInsideSharedFolder(e)||t.isEncryptedFile(e)?void 0:e,filterValidUser:e=>({user:e}),shouldShowForPreviewSurface:t.filterSurfaceIn(he),shouldShowForPreviewType:t.alwaysShow},Ce=t.withActionCondition(ge,((e,i,n,o,s,a)=>{const l=function({getActiveFile:e,user:i},n){const{file:o,sharedLinkInfo:c,sharePermission:s}=e();return t.canConvertFile(o,s)&&t.canDownloadFile(c,s)?r.getConversionActionsForFiles(i,[o],{},n):[]}({getActiveFile:n,user:e.user},o);if(l.length)return{label:t.FILE_CONVERSION_STRING,userAction:t.UserAction.OpenSaveAs,disabled:{disabled:!1},icon:c.ConvertFileLine,action:{type:"menu",menu:Se.default.createElement(Ee,{context:t.UserActionContext.FileMenu,conversionActions:l,encryptionOptions:s,file:e.file,logUserAction:i,user:e.user,sharedLinkInfo:n().sharedLinkInfo,sharePermissions:n().sharePermission,previewSurface:a})}}}),void 0),Te=(e,i)=>({userAction:void 0,disabled:i,action:{type:"click",handler:async()=>e()},label:t.INFO_ACTION_STRING,accessibleLabel:t.INFO_ACCESSIBILITY_STRING,icon:t.InfoLine}),me=t.withActionCondition(t.moveActionCondition,((i,n,o,r,c,s)=>({label:t.MOVE_ACTION_STRING,icon:t.MoveLine,userAction:t.UserAction.Move,disabled:i.file.read_only?{disabled:!0,tooltipMessage:t.ACTION_DISABLED_STRING}:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,n){e(["./c_action_plugins_move_action_action"],i,n)})).then((({moveActionWrapper:e})=>e({file:i.file,user:i.user,previewType:n,previewSurface:o,onFileChanged:r,browseContext:c,browseExceptions:s})))}})),void 0);const De=()=>{const{optionalIOClients:{printClient:e}}=t.useFileViewerContext(),i=function(){var e,i,n;const o=t.useRootPreviewMetadata();if(!o)return"";const{content:r}=o;return"image"===(null==r?void 0:r[".tag"])?null!==(e=null==r?void 0:r.full_size_src)&&void 0!==e?e:"":"ssr_doc"===(null==r?void 0:r[".tag"])?null!==(i=null==r?void 0:r.autoprint_url)&&void 0!==i?i:"":"text"===(null==r?void 0:r[".tag"])&&null!==(n=null==r?void 0:r.extracted_text)&&void 0!==n?n:""}(),n=t.useRootPreviewType();return Se.default.useMemo((()=>()=>{i&&(null==e||e.print(i,n))}),[n,e,i])},be=[t.PreviewType.SsrDoc,t.PreviewType.Image,t.PreviewType.Text,t.PreviewType.Excel],Oe={shouldShowForPreviewSurface:t.alwaysShow,shouldShowForPreviewType:t.filterPreviewTypeIn(be),filterValidUser:e=>({user:e}),filterValidFile:(e,i,n)=>n||t.isEncryptedFile(e)?void 0:e},Ne=t.withActionCondition(Oe,((e,i)=>({label:t.PRINT_ACTION_STRING,userAction:t.UserAction.Print,disabled:{disabled:!1},action:{type:"click",handler:async()=>i()},icon:c.PrintLine})),void 0),Re=t.withActionCondition(t.renameActionConditions,((e,i)=>({label:t.RENAME_ACTION_STRING,icon:t.CursorLine,userAction:t.UserAction.Rename,action:{type:"click",handler:async()=>{i(!0)}},disabled:{disabled:!1}})),void 0),Le=t.withActionCondition(t.starActionConditions,((e,i,n,o,r)=>({label:o,icon:n,userAction:i?t.UserAction.Unstar:t.UserAction.Star,action:{type:"click",handler:async()=>r()},disabled:{disabled:!1}})),void 0),ye=o.defineMessage({id:"pB6h1Y",defaultMessage:"Archive files over 512 MB cannot be extracted"}),Fe=t.withActionCondition(t.unzipActionConditions,((i,n)=>{const o=i.file.bytes/1048576;return{label:t.UNZIP_ACTION_MESSAGE,icon:t.UnzipAction.actionIcon,disabled:o>=t.UNZIP_MAX_FILESIZE_MB?{disabled:!0,tooltipMessage:ye}:{disabled:!1},userAction:t.UserAction.Unzip,action:{type:"click",handler:()=>new Promise((function(i,n){e(["./c_action_plugins_unzip_action_action"],i,n)})).then((({unzipAction:e})=>e({user:i.user,file:i.file,shareToken:n})))}}}),void 0),Ke=[t.SDKPreviewSurface.BROWSE,t.SDKPreviewSurface.BACKUP,t.SDKPreviewSurface.FILE_LOCKING,t.SDKPreviewSurface.HELLOSIGN,t.SDKPreviewSurface.HOME,t.SDKPreviewSurface.INBAND_SHARE,t.SDKPreviewSurface.PHOTOS,t.SDKPreviewSurface.RECENTS,t.SDKPreviewSurface.SEARCH,t.SDKPreviewSurface.SHARED_CONTENT_LINK,t.SDKPreviewSurface.SHARED_LINK,t.SDKPreviewSurface.STANDALONE_PREVIEW,t.SDKPreviewSurface.STARRED,t.SDKPreviewSurface.POLLUX_DESKTOP_PREVIEW,t.SDKPreviewSurface.POLLUX_DESKTOP_SEARCH_PREVIEW],Me={filterValidFile:e=>function(e){const i=t.fileActionCondition.filterValidFile(e);return!!i&&!l.isCloudBasedDoc(i)&&!t.isWebShortcutByExtension(i.fq_path)}(e)?e:void 0,filterValidUser:t.filterLoggedInUser,shouldShowForPreviewSurface:t.filterSurfaceIn(Ke),shouldShowForPreviewType:t.alwaysShow};const ke=t.withActionCondition(Me,(i=>({label:t.VERSION_HISTORY_ACTION_STRING,icon:t.ClockLine,userAction:t.UserAction.VersionHistory,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,n){e(["./c_action_plugins_version_history_action_action"],i,n)})).then((({versionHistoryActionWrapper:e})=>e(i.file,i.user)))}})),void 0);i.default=({contentProps:e})=>{var i,n;const{previewSurface:o,pluginArgs:r,fileConfig:c,hasOpenInActions:a}=t.usePluginMigrationContext(),{logUserAction:l,featureConfig:u}=t.useFileViewerContext(),d=null!==(i=t.useCurrentPreviewMetadata().previewType)&&void 0!==i?i:t.PreviewType.Loading,S=r.getActiveFile().file,f=r.getActiveFile().sharePermission,v=r.user,p=t.useRootFile(),{data:w}=t.useFileContentMetadataQuery(p),A=t.useIsNestedArchiveFile(),I=null===(n=null==w?void 0:w.apiData)||void 0===n?void 0:n.metadata,{onFileChanged:E,browseContext:P,browseExceptions:h,canRestoreRevision:g,getActiveFile:C,shareToken:T,encryptionOptions:m,allowUnrequestedSusiModal:D,onRestoreRevision:b,userPresentableVerdict:O}=r,N=Se.useMemo((()=>({file:S,user:v,previewSurface:o,previewType:d,sharePermission:f,isNestedArchiveFile:A,canRestoreRevision:g})),[S,g,A,o,d,f,v]),R=(e=>{const i=t.useSetLeftSidebarCallback(t.UserActionContext.FileMenu);return Se.default.useMemo((()=>Ie(e,(()=>i(t.FILE_ACTIVITY_PLUGIN_ID)))),[e,i])})(N),L=(e=>{const i=t.useSetLeftSidebarCallback(t.UserActionContext.FileMenu),{previewSurface:n}=e,o=n===t.SDKPreviewSurface.LOW_DISTRACTION_VIEW,r=Se.default.useMemo((()=>o?{disabled:!0,tooltipMessage:t.DISABLED_FOR_THIS_FILE_TOOLTIP_STRING}:{disabled:!1}),[o]);return Se.default.useMemo((()=>Te((()=>i(t.INFO_BLADE_PLUGIN_ID)),r)),[i,r])})(N),y=((e,i)=>{const{onPrint:n}=t.usePreviewControls(),o=De(),r=t.useStabilizedCallback((()=>{null==n||n(),o()}));return Se.default.useMemo((()=>i.enable_print?Ne(e,r):void 0),[e,i.enable_print,r])})(N,c),F=((e,i)=>{const n=t.getStoreForStarred(),{isStarred:o,message:r,iconSrc:c,handleClick:s}=t.useStarControlWithStore({getActiveFile:i,user:e.user,starredStore:n});return Se.default.useMemo((()=>Le(e,o,c,r,s)),[e,s,c,o,r])})(N,C),K=t.useToggleRenameStateCallback(),M=t.useSetDeleteFileModalOpenCallback(),k=t.useEmitter$2(),x=Se.useCallback((e=>{t.isSharedFile(S)&&k.select(t.ON_CLICK_SHARED_CONTENT_ACTION).emit({actionElement:"action_bar",action:e})}),[k,S]),U=Se.useMemo((()=>[[me(N,d,o,E,P,h),ve(N,d,P,h),pe(N,l,M,o,E),Re(N,K)],[F],[L,ke(N),R],[s.makeOpenInAction(N,!!a),Ce(N,l,C,I,m,o),Fe(N,T),...t.makeDownloadActions(N,C,l,I,o,D,T,f,m,null==p?void 0:p.name,t.UserActionContext.FileMenu,x,O,null==u?void 0:u.copy_to_dropbox_folder_picker),t.makeRestoreAction(N,b)],[y]]),[N,d,o,E,P,h,l,M,K,F,L,R,a,C,I,m,T,D,f,null==p?void 0:p.name,x,O,null==u?void 0:u.copy_to_dropbox_folder_picker,b,y]),V=Se.useCallback((e=>l(e,t.UserActionContext.FileMenu)),[l]);return Se.createElement(_.TitlebarMenuContent,{options:U,elementId:"file-menu",contentProps:e,logAction:V})}}));
//# sourceMappingURL=c_title_bar_dropdowns_titlebar_file_dropdown.after-display.js-vfl4BdU9C.map

//# debugId=aa628ee5-bc2a-3010-9563-1c8e7140a2c6