!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},n=(new e.Error).stack;n&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[n]="65cda1b5-beb2-30ca-86ed-54aa3cc13ba9")}catch(e){}}();
define(["require","exports","react","./c_core_i18n","./e_file_viewer_static_scl_page_file","./c_file_viewer_components_titlebar_menu_content","./e_core_exception","./c_src_sink_index","./c_browser_browser_detection","./c_lodash-es_lodash","./c_memoize-one","metaserver/static/js/langpack","./c_init_data_edison","./c_init_data_debug_panel","./e_edison","./c_api_v2_routes_password_confirmation_provider","./c_pap-events_navigation_select_create_folder_action","./e_data_modules_stormcrow","./c_react-use_misc_util","./c_api_v2_client_base","./c_watermarking_utils_getImageDefaultSizes","./c_core_notify","react-dom","./c_security_csrf_hmac"],(function(e,i,t,n,o,r,a,c,s,l,d,_,u,A,E,g,S,p,T,f,I,C,b,U){"use strict";function N(e){if(e&&e.__esModule)return e;var i=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var n=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(i,t,n.get?n:{enumerable:!0,get:function(){return e[t]}})}})),i.default=e,Object.freeze(i)}var P=N(t);const L=({logUserAction:e,setActiveEditorCallback:i})=>[{icon:o.ShapeRotateLeftLine,label:o.ROTATE_LEFT_TOOLTIP,userAction:o.UserAction.RotateLeft,disabled:{disabled:!1},action:{type:"click",handler:o.rotateLeftHandler(e,i,o.UserActionContext.EditMenu)}},{icon:o.ShapeRotateRightLine,label:o.ROTATE_RIGHT_TOOLTIP,userAction:o.UserAction.RotateRight,disabled:{disabled:!1},action:{type:"click",handler:o.rotateRightHandler(e,i,o.UserActionContext.EditMenu)}}],R=({logUserAction:e,setActiveEditorCallback:i})=>[{icon:o.FlipHorizontalLine,label:o.FLIP_HORIZONTAL_LABEL,userAction:o.UserAction.FlipHorizontal,disabled:{disabled:!1},action:{type:"click",handler:o.flipHorizontalHandler(e,i,o.UserActionContext.EditMenu)}},{icon:o.FlipVerticalLine,label:o.FLIP_VERTICAL_LABEL,userAction:o.UserAction.FlipVertical,disabled:{disabled:!1},action:{type:"click",handler:o.flipVerticalHandler(e,i,o.UserActionContext.EditMenu)}}],v=({logUserAction:e,setActiveEditorCallback:i})=>({icon:o.CropLine,label:o.CROP_TOOLTIP,disabled:{disabled:!1},userAction:o.UserAction.Crop,action:{type:"click",handler:o.cropHandler(e,i,o.UserActionContext.EditMenu)}}),h=({logUserAction:e,setActiveEditorCallback:i,previewType:t})=>({icon:o.CutLine,label:o.TRIM_TOOLTIP,userAction:o.UserAction.Trim,disabled:{disabled:!1},action:{type:"click",handler:o.trimHandler(e,i,o.UserActionContext.EditMenu)}}),w=(e,i,t)=>{if(!o.getActionCondition(e,o.audioVideoEditingActionCondition))return[];const n=e.previewType===o.PreviewType.Video,r=e.previewType===o.PreviewType.Audio;return n?D(i,t):r?m(i,t):[]},D=(e,i)=>{const t={logUserAction:e,setActiveEditorCallback:i,previewType:o.PreviewType.Video};return[h(t),v(t),...L(t),...R(t)]},m=(e,i)=>{const t={logUserAction:e,setActiveEditorCallback:i,previewType:o.PreviewType.Video};return[h(t)]},O=n.defineMessage({id:"1wQEUl",defaultMessage:"Rotate right"}),y=n.defineMessage({id:"2BgLiN",defaultMessage:"Rotate left"}),M=n.defineMessage({id:"tupnL9",defaultMessage:"Crop"}),F=n.defineMessage({id:"VghM9c",defaultMessage:"Flip"}),k=n.defineMessage({id:"nUBVPc",defaultMessage:"Adjust"}),H=n.defineMessage({id:"qBO39c",defaultMessage:"Enhance"}),x=o.withActionCondition(o.imageEditingActionCondition,((e,i,t,n,r,a)=>((e,i,t,n,r)=>{const a=(null==t?void 0:t.upscale)||(null==t?void 0:t.colorCorrect)||(null==t?void 0:t.autoStraighten)||(null==t?void 0:t.filter),c=[{icon:o.ShapeRotateLeftLine,label:y,userAction:o.UserAction.RotateLeft,disabled:{disabled:!1},action:{type:"click",handler:o.onRotate(o.RotationDirection.LEFT,e,i,o.UserActionContext.EditMenu)}},{icon:o.ShapeRotateRightLine,label:O,userAction:o.UserAction.RotateRight,disabled:{disabled:!1},action:{type:"click",handler:o.onRotate(o.RotationDirection.RIGHT,e,i,o.UserActionContext.EditMenu)}},{icon:o.FlipHorizontalLine,label:F,userAction:o.UserAction.FlipHorizontal,disabled:{disabled:!1},action:{type:"click",handler:o.onFlip(e,i,o.UserActionContext.EditMenu)}},{icon:o.CropLine,label:M,userAction:o.UserAction.Crop,disabled:{disabled:!1},action:{type:"click",handler:o.onCrop(e,i,o.UserActionContext.EditMenu)}},{icon:o.SliderLine,label:k,userAction:o.UserAction.Adjust,disabled:{disabled:!1},action:{type:"click",handler:o.onAdjust(e,i,o.UserActionContext.EditMenu)}}];if(a){let r;n&&"image"===n[".tag"]&&n.image_width&&n.image_height&&(r={width:n.image_width,height:n.image_height}),c.push({icon:o.ImageEnhanceLine,label:H,userAction:o.UserAction.Enhance,disabled:{disabled:!1},action:{type:"menu",menu:P.default.createElement(o.MagicTools,{onUpscale:o.onUpscale(e,i,o.UserActionContext.EditMenu),onColorCorrect:o.onColorCorrect(e,i,o.UserActionContext.EditMenu),onAutoStraighten:o.onAutoStraighten(e,i,o.UserActionContext.EditMenu),onFilter:o.onImageFilter(e,i,o.UserActionContext.EditMenu),imageDimensions:r,previewsImageEnhancements:t})}})}return c.concat(r)})(i,t,n,r,a)),[]),G=o.withActionCondition(o.pdfEditActionCondition,((i,t,n,r,a,c,s)=>{const l=[{label:o.DRAW_PDF_ACTION_STRING,icon:o.ScribbleLine,userAction:o.UserAction.Draw,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_pdf_edit_action_action"],i,t)})).then((({pdfEditAction:e})=>e({setActiveEditorCallback:n,logUserAction:t,getCurrentPage:r,previewSurface:s},o.UserActionContext.EditMenu,(e=>{let i=o.NonSignEntryPoints.UNFURL_ACTIONS_DRAW;return e===o.SDKPreviewSurface.BROWSE?i=o.NonSignEntryPoints.BROWSE_PREVIEW_UNFURL_ACTIONS_DRAW:e===o.SDKPreviewSurface.STANDALONE_PREVIEW?i=o.NonSignEntryPoints.STANDALONE_PREVIEW_UNFURL_ACTIONS_DRAW:e===o.SDKPreviewSurface.SHARED_LINK&&(i=o.NonSignEntryPoints.SHARED_LINK_UNFURL_ACTIONS_DRAW),i})(s))))}}],d=[{label:o.HIGHLIGHT_PDF_ACTION_STRING,icon:o.HighlightLine,userAction:o.UserAction.Highlight,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_pdf_edit_action_action"],i,t)})).then((({pdfEditAction:e})=>e({setActiveEditorCallback:n,logUserAction:t,getCurrentPage:r,previewSurface:s},o.UserActionContext.EditMenu,(e=>{let i=o.NonSignEntryPoints.UNFURL_ACTIONS_HIGHLIGHT;return e===o.SDKPreviewSurface.BROWSE?i=o.NonSignEntryPoints.BROWSE_PREVIEW_UNFURL_ACTIONS_HIGHLIGHT:e===o.SDKPreviewSurface.STANDALONE_PREVIEW?i=o.NonSignEntryPoints.STANDALONE_PREVIEW_UNFURL_ACTIONS_HIGHLIGHT:e===o.SDKPreviewSurface.SHARED_LINK&&(i=o.NonSignEntryPoints.SHARED_LINK_UNFURL_ACTIONS_HIGHLIGHT),i})(s))))}}],_=[{label:o.ADD_TEXT_PDF_ACTION_STRING,icon:o.TextBoxLine,userAction:o.UserAction.AddText,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_pdf_edit_action_action"],i,t)})).then((({pdfEditAction:e})=>e({setActiveEditorCallback:n,logUserAction:t,getCurrentPage:r,previewSurface:s},o.UserActionContext.EditMenu,(e=>{let i=o.NonSignEntryPoints.UNFURL_ACTIONS_ADD_TEXT;return e===o.SDKPreviewSurface.BROWSE?i=o.NonSignEntryPoints.BROWSE_PREVIEW_UNFURL_ACTIONS_ADD_TEXT:e===o.SDKPreviewSurface.STANDALONE_PREVIEW?i=o.NonSignEntryPoints.STANDALONE_PREVIEW_UNFURL_ACTIONS_ADD_TEXT:e===o.SDKPreviewSurface.SHARED_LINK&&(i=o.NonSignEntryPoints.SHARED_LINK_UNFURL_ACTIONS_ADD_TEXT),i})(s))))}}],u=a?[{label:o.EDIT_TEXT_PDF_ACTION_STRING,icon:o.PlaceholderTextLine,userAction:o.UserAction.EditPdfText,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_pdf_edit_action_action"],i,t)})).then((({pdfEditAction:e})=>e({setActiveEditorCallback:n,logUserAction:t,getCurrentPage:r,previewSurface:s},o.UserActionContext.EditMenu,(e=>{let i=o.NonSignEntryPoints.UNFURL_ACTIONS_EDIT_TEXT;return e===o.SDKPreviewSurface.BROWSE?i=o.NonSignEntryPoints.BROWSE_PREVIEW_UNFURL_ACTIONS_EDIT_TEXT:e===o.SDKPreviewSurface.STANDALONE_PREVIEW?i=o.NonSignEntryPoints.STANDALONE_PREVIEW_UNFURL_ACTIONS_EDIT_TEXT:e===o.SDKPreviewSurface.SHARED_LINK&&(i=o.NonSignEntryPoints.SHARED_LINK_UNFURL_ACTIONS_EDIT_TEXT),i})(s))))}}]:[];return[...l,...d,..._,...u,...c,...[{label:o.ALL_EDITING_TOOLS_ACTION_STRING,icon:o.EditLine,userAction:o.UserAction.EditPdf,disabled:{disabled:!1},action:{type:"click",handler:()=>new Promise((function(i,t){e(["./c_action_plugins_pdf_edit_action_action"],i,t)})).then((({pdfEditAction:e})=>e({setActiveEditorCallback:n,logUserAction:t,getCurrentPage:r,previewSurface:s},o.UserActionContext.EditMenu)))}}]]}),[]),W=o.withActionCondition(o.selfSignActionCondition,((e,i,t,n,r,a,c,s)=>{if(r||a)return;const l=o.getSelfSignActionArgs(i,t,e.user,e.file,n,o.UserActionContext.EditMenu,c);return V(l,s)}),void 0),V=(i,t)=>({label:o.SIGN_YOURSELF_ACTION_STRING,icon:o.SignatureLine,userAction:o.UserAction.SelfSign,disabled:{disabled:!1},action:{type:"click",handler:async()=>{i.user?await new Promise((function(i,t){e(["./c_action_plugins_self_sign_action_action"],i,t)})).then((({selfSignAction:e})=>e(i))):null==t||t()}}}),K=o.withActionCondition(o.sendForSignatureActionCondition,((e,i,t,n,r,a,c,s)=>{if(r||a)return;const l=o.getActionArgs(t,i,e.user,e.file,n,c);return B(l,s)}),void 0),B=(i,t)=>({label:o.GET_SIGNAURES_ACTION_STRING,icon:o.SignableDocumentPictogram,userAction:o.UserAction.SendForSignature,disabled:{disabled:!1},action:{type:"click",handler:async()=>{i.user?await new Promise((function(i,t){e(["./c_action_plugins_send_for_signature_action_action"],i,t)})).then((({sendForSignatureAction:e})=>e(i))):null==t||t()}}}),j=o.withActionCondition(o.textEditingActionCondition,((e,i,t)=>((e,i)=>[{icon:o.EditLine,label:o.editContentText,disabled:{disabled:!1},action:{type:"click",handler:o.onEdit(e,i,o.UserActionContext.EditMenu)},userAction:o.UserAction.EditText}])(i,t)),[]),X=o.withActionCondition(o.watermarkActionCondition,((e,i)=>({label:n.defineMessage({id:"MqyPTe",defaultMessage:"Watermark"}),userAction:o.UserAction.Watermark,disabled:{disabled:!1},icon:o.StampLine,action:{type:"click",handler:async()=>i(o.WATERMARKING_PLUGIN_ID,o.UserActionContext.EditMenu)}})),void 0);i.default=({contentProps:i,setMenuDisabled:t})=>{var a,c;const s=n.useIntl(),{pluginArgs:l,previewSurface:d}=o.usePluginMigrationContext(),{logUserAction:_}=o.useFileViewerContext(),u=null!==(a=o.useCurrentPreviewMetadata().previewType)&&void 0!==a?a:o.PreviewType.Loading,A=l.getActiveFile().file,E=l.getActiveFile().sharePermission,g=l.getActiveFile().sharedLinkInfo,S=o.useCurrentPageCount(),p=o.useSetActiveEditorCallback(),T=o.useIsNestedArchiveFile(),f=o.useRootFile(),{data:I}=o.useFileContentMetadataQuery(f),C=null===(c=null==I?void 0:I.apiData)||void 0===c?void 0:c.metadata,b=o.useGetCurrentDocPageCallback(),{user:U,encryptionOptions:N}=l,L=o.useCanEditTextPDF(U),R=o.useUserHasDmtConflict(),v=o.useShouldDisableFeaturesIfTeamSuspended(),h=P.useMemo((()=>({file:A,user:U,previewSurface:d,previewType:u,isNestedArchiveFile:T,sharePermission:E,sharedLinkInfo:g})),[A,U,d,u,E,T,g]),D=o.useImageEnhancements(U).previewsImageEnhancements,m=((e,i)=>{const t=o.useCanWatermarkFile({file:e.file,user:e.user});return P.default.useMemo((()=>t?X(e,i):void 0),[t,e,i])})(h,p),O=P.useMemo((()=>m?[m]:[]),[m]),y=P.useMemo((()=>async()=>{const{showAuthModal:i}=await new Promise((function(i,t){e(["./e_file_viewer_static_scl_page_file"],i,t)})).then((function(e){return e.show_auth_modal_esnext}));i({...{mode:o.Mode.REGISTER,encryptionOptions:N,kind:o.LoginOrRegisterKind.LOGGED_OUT_PDF_SIGN,authDialogPreviousElement:o.AuthDialogPreviousElementTag.EDIT,loggingExtra:{signup_source:"sign"},sharedLinkUrl:null==g?void 0:g.url,webSignInTag:o.getWebSignInTag(!!h.user,h.previewSurface,h.sharePermission),sharedLinkInfo:g}})}),[h.previewSurface,h.sharePermission,h.user,N,g]),M=P.useMemo((()=>{const e=u===o.PreviewType.Image?[]:[W(h,_,p,S,R,v,h.previewSurface,y),K(h,_,p,S,R,v,h.previewSurface,y)];return[[...G(h,_,p,b,L,O,h.previewSurface),...x(h,p,_,D,C,O),...w(h,_,p),...j(h,p,_)],[...e]]}),[h,_,p,b,O,S,R,v,u,D,L,C,y]),F=o.useAudioVideoEditDisabledTooltipMsg(null==f?void 0:f.name,null==f?void 0:f.size),k=o.useIsAudioOnlyVideo(),H=u===o.PreviewType.Image||u===o.PreviewType.SsrDoc;let V;const B=M.every((e=>e.every((e=>!e))));F?V=F:o.isDownloadPluginEnabled(A,E)?l.user||H?(B||k)&&(V=s.formatMessage({id:"qURjdV",defaultMessage:"Not available for this file"})):V=s.formatMessage({id:"8QvtQB",defaultMessage:"Log in or sign up to edit"}):V=s.formatMessage(o.DISABLED_FOR_THIS_FILE_TOOLTIP_STRING),P.useEffect((()=>{t({disabled:!!V,tooltip:V})}),[t,M,V]);const z=P.useCallback((e=>_(e,o.UserActionContext.EditMenu)),[_]);return P.createElement(r.TitlebarMenuContent,{contentProps:i,elementId:"edit-menu",options:M,logAction:z})}}));
//# sourceMappingURL=c_title_bar_dropdowns_titlebar_edit_dropdown.js-vfls3tuPQ.map

//# debugId=65cda1b5-beb2-30ca-86ed-54aa3cc13ba9